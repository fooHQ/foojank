server_name: nats-srv-1
listen: 0.0.0.0:4222

jetstream: enabled

websocket {
	listen: 0.0.0.0:80
	no_tls: true
	same_origin: false
	compression: false
}

# This is only temporary.
# The configuration should be managed dynamically by nsc.
accounts: {
    AGENT001: {
        jetstream: enabled
        users: [
            {
                user: "agent001",
                password: "password"
                permissions: {
                    subscribe: [
                        "_INBOX.>"
                        "$SRV.PING"
                        "$SRV.PING.>"
                        "$SRV.INFO"
                        "$SRV.INFO.>"
                        "$SRV.STATS"
                        "$SRV.STATS.>"
                        "rpc"
                        "data"
                        "stdin"
                    ]
                    publish: [
                        "$JS.API.STREAM.INFO.*"
                        "$JS.API.DIRECT.GET.>"
                        "$JS.API.CONSUMER.CREATE.>"
                        "$JS.API.CONSUMER.DELETE.>"
                        "stdout"
                    ]
                    allow_responses: {
                        max: 1
                    }
                }
            }
        ]
        exports: [
            { service: "$JS.API.STREAM.LIST" }
            { service: "$JS.API.STREAM.CREATE.*" }
            { service: "$JS.API.STREAM.INFO.*" }
            { service: "$JS.API.DIRECT.GET.>" }
            { service: "$JS.API.CONSUMER.CREATE.>" }
            { service: "$JS.API.CONSUMER.DELETE.>" }
            { service: "$O.*.M.*" }
            { service: "$O.*.C.*" }
            { service: "$SRV.PING" }
            { service: "$SRV.PING.>" }
            { service: "$SRV.INFO" }
            { service: "$SRV.INFO.>" }
            { service: "$SRV.STATS" }
            { service: "$SRV.STATS.>" }
            { service: "rpc" }
            { service: "data" }
            { service: "stdin" }
            { stream: "stdout" }
        ]
    }

    MANAGER001: {
        jetstream: enabled
        users: [
            {
                user: "manager001",
                password: "password"
                permissions: {
                    publish: [
                        "$JS.API.STREAM.LIST"
                        "$JS.API.STREAM.CREATE.*"
                        "$JS.API.STREAM.INFO.*"
                        "$JS.API.DIRECT.GET.>"
                        "$JS.API.CONSUMER.CREATE.>"
                        "$JS.API.CONSUMER.DELETE.>"
                        # Copy file to object store
                        "$O.*.M.*"
                        "$O.*.C.*"
                        "$SRV.PING"
                        "$SRV.PING.>"
                        "$SRV.INFO"
                        "$SRV.INFO.>"
                        "$SRV.STATS"
                        "$SRV.STATS.>"
                        "rpc"
                        "data"
                        "stdin"
                    ]
                    subscribe: [
                        "_INBOX.>"
                        "stdout"
                    ]
                }
            }
        ]
        imports: [
            { service: { subject: "$JS.API.STREAM.LIST", account: AGENT001 } }
            { service: { subject: "$JS.API.STREAM.CREATE.*", account: AGENT001 } }
            { service: { subject: "$JS.API.STREAM.INFO.*", account: AGENT001 } }
            { service: { subject: "$JS.API.DIRECT.GET.>", account: AGENT001 } }
            { service: { subject: "$JS.API.CONSUMER.CREATE.>", account: AGENT001 } }
            { service: { subject: "$JS.API.CONSUMER.DELETE.>", account: AGENT001 } }
            { service: { subject: "$O.*.M.*", account: AGENT001 } }
            { service: { subject: "$O.*.C.*", account: AGENT001 } }
            { service: { subject: "$SRV.PING", account: AGENT001 } }
            { service: { subject: "$SRV.PING.>", account: AGENT001 } }
            { service: { subject: "$SRV.INFO", account: AGENT001 } }
            { service: { subject: "$SRV.INFO.>", account: AGENT001 } }
            { service: { subject: "$SRV.STATS", account: AGENT001 } }
            { service: { subject: "$SRV.STATS.>", account: AGENT001 } }
            { service: { subject: "rpc", account: AGENT001 } }
            { service: { subject: "data", account: AGENT001 } }
            { service: { subject: "stdin", account: AGENT001 } }
            { stream: { subject: "stdout", account: AGENT001 } }
        ]
    }
}
